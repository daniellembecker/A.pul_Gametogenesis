---
title: "HOBO_temp_processing"
author: "daniellembecker"
date: "4/5/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##Processing temperature data for from HOBO loggers out at Mahana from February-April


##Install packages
# load packages

```{r}
library("segmented")
library("devtools")
library("plotrix")
library("gridExtra")
library("LoLinR")
library("lubridate")
library('tidyverse')
library('lubridate')
library('scales')
```


#load temp data

```{r}
mahana.temp.hobo.06 <- read.csv("RAnalysis/data/HOBO/April2022_mahana_loggers/Mahana_6.csv")
mahana.temp.hobo.09 <- read.csv("RAnalysis/data/HOBO/April2022_mahana_loggers/Mahana_9.csv")
mahana.temp.hobo.07 <- read.csv("RAnalysis/data/HOBO/April2022_mahana_loggers/20444028_Mahana_7.csv")
mahana.temp.hobo.10 <- read.csv("RAnalysis/data/HOBO/November2022_mahana_loggers/20221114_Mahana_10.csv")
mahana.temp.hobo.11 <- read.csv("RAnalysis/data/HOBO/November2022_mahana_loggers/20221114_Mahana_11.csv")
mahana.temp.hobo.12 <- read.csv("RAnalysis/data/HOBO/November2022_mahana_loggers/20221114_Mahana_12.csv")
mahana.temp.hobo.13 <- read.csv("RAnalysis/data/HOBO/November2022_mahana_loggers/20221114_Mahana_13.csv")
mahana.temp.hobo.08 <- read.csv("RAnalysis/data/HOBO/November2022_mahana_loggers/20221114_Mahana_8.csv")
mahana.temp.hobo.05 <- read.csv("RAnalysis/data/HOBO/November2022_mahana_loggers/20221114_Mahana_5.csv")
mahana.temp.hobo.04 <- read.csv("RAnalysis/data/HOBO/November2022_mahana_loggers/20221114_Mahana_4.csv")
mahana.temp.hobo.03 <- read.csv("RAnalysis/data/HOBO/November2022_mahana_loggers/20221114_Mahana_3.csv")
mahana.temp.hobo.02 <- read.csv("RAnalysis/data/HOBO/November2022_mahana_loggers/20221114_Mahana_2.csv")
```


#bind all data sets together into one data frame

```{r}
temp.data <- rbind(mahana.temp.hobo.02, mahana.temp.hobo.03, mahana.temp.hobo.04, mahana.temp.hobo.05, mahana.temp.hobo.06, mahana.temp.hobo.07, mahana.temp.hobo.08, mahana.temp.hobo.09, mahana.temp.hobo.10, mahana.temp.hobo.11, mahana.temp.hobo.12, mahana.temp.hobo.13)
```


#remove any NA's from the data frame
```{r}
temp.data <- na.omit(temp.data)

view(temp.data)
```

#modify the date and time structure

```{r}
temp.data$date.time <- mdy_hm(temp.data$date.time, quiet=FALSE, tz="UTC", truncated=0) #format date and time
```
 

#save file as csv so transforms to data frame
```{r}
write.csv(temp.data, 'RAnalysis/output/HOBO/20240129_mahana_temp_data.csv')
```
 

#make logger number a factor
```{r}
temp.data$logger.number = as.factor(temp.data$logger.number)
```


#subset temp data for mean across loggers
```{r}
# Separate date and temperature from the "date.temp" column
temp.data.sep <- temp.data %>%
  separate(date.time, into = c("date", "time"), sep = " ")

# Convert Temp to numeric
temp.data.sep$temp <- as.numeric(temp.data.sep$temp)

# Group by Date and calculate the mean temperature for each day
mean_temp_per_day <- temp.data.sep %>%
  group_by(date) %>%
  summarise(mean_temp = mean(temp))

# Assuming your "date" column is not yet of class Date
mean_temp_per_day$date <- as.Date(mean_temp_per_day$date)

filtered_data <- mean_temp_per_day %>%
  filter((date >= as.Date("2022-01-24") & date <= as.Date("2022-11-04")))

filtered_data <- filtered_data %>%
  filter(date != as.Date("2022-08-07"))

```


#plot data by hobo logger per day no average

```{r}

temp.plot <- filtered_data %>%
  ggplot(aes(x=date, y=mean_temp))+
  geom_line() + 
  geom_point() +
  scale_x_date(date_breaks = "4 day", date_labels = "%m-%d") +
  theme_classic()+
  theme(axis.text.x = element_text(angle = 90)) +
  ylab("Temperature (Â°C)")+
  xlab("Date")+
  theme(axis.title = element_text(size = 16),   # Adjust the size of x and y axis labels
        axis.text = element_text(size = 16)) ;temp.plot

ggsave(filename="RAnalysis/output/HOBO/20240129_temp_logger_plot.pdf", plot=temp.plot, width=30, height=10, units="in")

ggsave(filename="RAnalysis/output/HOBO/20240129_temp_logger_plot.png", plot=temp.plot, width=20, height=10, units="in")
```

